---
title: defineOptions
description: Allows defining integration options while keeping the whole thing type-safe.
---

`defineOptions` allows defining an integration's options while keeping the whole thing type-safe.

```ts title="my-integration/index.ts" "defineOptions" ins={2,4-6,8-10,14-16}
import { defineIntegration, defineOptions } from "astro-integration-kit";
import { z } from "astro/zod";

const OptionsSchema = z.object({
    foo: z.string().optional().default("bar"),
});

type Options = {
    foo?: z.infer<typeof OptionsSchema>["foo"];
}

export default defineIntegration({
    // ...
    options: defineOptions<Options>({
        schema: OptionsSchema,
    }),
})
```

## Usage

Pass an explicit generic type to `defineOptions`. We recommend that you extract it so that:

1. Your users can consume it
2. You can add JSDoc annotations easily

```ts title="my-integration/index.ts"
import { defineIntegration, defineOptions } from "astro-integration-kit";
import { z } from "astro/zod";

const OptionsSchema = z.object({
    foo: z.string().optional().default("bar"),
});

export type Options = {
    /** A useful comment */
    foo?: z.infer<typeof OptionsSchema>["foo"];
}

export default defineIntegration({
    // ...
    options: defineOptions<Options>({
        schema: OptionsSchema,
    }),
})
```

`defineOptions` also requires an argument to handle runtime validation.

:::caution[If you're not using zod]
When typing optional properties within your `IntegrationOptions`, make sure to specify `undefined` as a possible value.

```ts "undefined"
interface IntegrationOptions {
    foo?: string | undefined;
}
```
:::

We recommend that you extend the strictest Astro TSConfig. This will help you create a more stable
integration across many platforms and environments.

```diff lang="json"
{
-  "extends": "astro/tsconfigs/strict"
+  "extends": "astro/tsconfigs/strictest"
}
```

## Why do I need a distinct utility?

Because ~~fuckin typescript that's why~~ we need plugins types to be inferred by TypeScript, we can't pass a type for
options as an explicit generic. Using a distinct utility allows us to work around that
issue and also make the API more powerful. In the future, it may not be a utility but a
function returned by `defineIntegration`, who knows!
