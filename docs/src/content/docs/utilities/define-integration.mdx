---
title: defineIntegration
description: Makes creating integrations easier, and adds a few goodies!
---

`defineIntegration` makes creating integrations easier, and adds a few goodies!

:::caution
`defineIntegration` is required for All-in mode.
:::

```ts title="my-integration/index.ts"
import { createResolver, defineIntegration, watchIntegration } from "astro-integration-kit";

export default defineIntegration<{ foo?: string }>({
    name: "my-integration",
    defaults: {
        foo: "bar"
    },
    setup({ options }) {
        const { resolve } = createResolver(import.meta.url);

        return {
            "astro:config:setup": () => {
                watchIntegration(resolve())
            }
        }
    }
})
```

## Features

### Options

The `defaults` configuration accepts the default values for your integration's options. `defaults` will be deeply merged with the options provided by the user. Please note that this is not runtime safe, it's good practice to check the types of your options inside `setup`.

### Additional hooks

Utilities provided by `astro-integration-kit` such as `addVitePlugin` and `addVirtualModule` are made directly available in their appropriate hooks.

```ts
import { defineIntegration } from "astro-integration-kit";

export default defineIntegration<{}>({
	name: "my-awesome-integration",
	defaults: {},
	setup: () => ({
		"astro:config:setup"({ addVirtualImport }) {
			addVirtualImport({
				name: "virtual:astro-integration-kit-playground/config",
				content: `export default ${JSON.stringify({ foo: "bar" })}`
			})
		}
	})
})
```

### Context & All-in mode

Using `defineIntegration` allows you to go [All-in](/getting-started/usage/#all-in). This means
that Astro hooks parameters are passed to our utilities through Context and you don't need
to pass them manually.

:::note
If you're curious, we're using [`unctx`](https://github.com/unjs/unctx) for this dark magic!
:::